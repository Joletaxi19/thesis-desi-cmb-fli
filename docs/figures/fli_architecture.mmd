flowchart TB
  %% =======================
  %% MODEL (forward process)
  %% =======================
  subgraph M["Model (Forward)"]
    direction TB
    A["δ_ini"] --> B["JAX-PM"]
    B --> C["δ_final"]
    C --> D["δ_g = F(δ_final)"]
    C -- ray-tracing --> E["κ-map (model)"]
  end

  %% =========
  %% DATA
  %% =========
  subgraph DTA["Data"]
    direction LR
    F["Planck + ACT κ-map"]:::data
    G["DESI DR1 LRG"]:::data
  end

  %% =======================
  %% LIKELIHOOD / INFERENCE
  %% =======================
  H["MCLMC — Likelihood"]:::like

  %% Connections to likelihood
  D -- model --> H
  E -- model --> H
  F -- data --> H
  G -- data --> H

  %% Posterior feedback to initial field
  H -. "posterior update (MCLMC)" .-> A

  %% Styles
  classDef data fill:#E7F2FF,stroke:#1E6BFF,stroke-width:1px,color:#0B3D91;
  classDef like fill:#FFF3E8,stroke:#F08A24,stroke-width:1.5px,color:#7A3E00;
  classDef default fill:#F8FBFD,stroke:#6B7280,stroke-width:1px,color:#111827;
